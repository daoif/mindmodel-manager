# MindModel Manager - SDD v3 体验优化与配置管理

> 基于 V2 版本的反馈修复与深度体验优化

---

## 1. 概述

本文档旨在解决 V2 版本验收中发现的问题，并进一步完善系统的可配置性与交互体验。

---

## 2. 配置管理 (Settings)

### 2.1 缺少"设置"页面
**问题**：V2 代码中已存在 `SettingsDimensions.vue` 但未配置路由入口，导致用户无法管理分类和标签。

**需求**：
1.  **新增路由**：
    *   `/settings/dimensions`: 标签维度管理
    *   `/settings/doc-types`: 文档类型管理
2.  **设置入口**：在侧边栏底部或顶部 Header 添加"设置"图标/链接。

### 2.2 维度配置增强
**需求**：在 `/settings/dimensions` 页面实现以下管理功能：
1.  **增删改查**：管理 `tag_dimensions` 表。
2.  **排序管理 (Nesting)**：
    *   通过拖拽或上下移动按钮调整 `display_order`。
    *   **原理**：左侧导航树的嵌套顺序完全依赖 `display_order`（排序第一的为一级目录，第二的为二级，以此类推）。
    *   **UI**：列表中应明确提示"排序决定导航树层级"。
3.  **颜色配置**：
    *   每行维度提供颜色选择器（Color Picker）。
    *   预设一组推荐色盘（Tailwind 风格），也支持自定义 Hex。
    *   该颜色将应用于该维度下所有标签的显示。

---

## 3. 导航交互优化 (Navigation)

### 3.1 一级标题点击无响应
**问题**：点击左侧导航栏的一级标题（如"场景"），右侧内容区未更新，必须点击到具体的二级值（如"创业"）才有效。

**修正**：
1.  **行为定义**：点击一级标题（维度节点）时，应被视为"未筛选任何特定值，但聚焦于该维度"（或等同于"全部"）。
2.  **预期效果**：由于一级标题本身不是一个过滤值（只是分组容器），点击它应当：
    *   **方案 A (推荐)**：仅折叠/展开子菜单（作为纯容器）。
    *   **方案 B**：显示该维度下所有模型的聚合视图。
    *   **最终决定**：鉴于用户反馈"无变化"是 bug，采取 **方案 A + 视觉反馈**。点击时展开/折叠，且要在 UI 上有明确的展开动画。如果用户期望筛选，需明确：点击"场景"本身不构成筛选条件，除非我们定义"包含任意场景标签的模型"。若用户意图是后者，则实现为：筛选 `tags[dim] is not empty`。
    *   **用户意图推测**：用户说"点击后左侧无变化"可能是指高亮状态没变，或者右侧列表没刷新。
    *   **V3 规范**：点击一级目录（维度名），右侧列表显示**所有包含该维度任意标签**的模型（即 `Has(Dimension)`），同时高亮该节点。

---

## 4. 筛选逻辑同步 (Unified Filtering)

### 4.1 侧边栏与筛选栏联动
**需求**：当通过左侧导航栏选择某个节点（如 场景 > 创业）时，顶部的"组合筛选栏"应自动同步该状态。

**交互规则**：
1.  **自动勾选**：左侧选中 "场景: 创业"，顶部筛选栏中 "场景" 分类的 "创业" 标签应自动变为**选中状态**。
2.  **锁定状态**：由左侧导航触发的筛选条件，在顶部筛选栏中应表现为**锁定**（Disabled / Locked）状态，禁止在顶部取消勾选。
    *   *原因*：左侧导航是"基底筛选" (Base Filter)，是当前视图的上下文。如果允许在顶部取消，会导致左侧高亮与右侧内容不一致。
    *   如果要取消该筛选，用户应点击左侧的 "全部" 或其他节点。
3.  **动态更新**：切换左侧节点，顶部筛选栏应立即刷新以反映新的基底条件。

---

## 5. 编辑体验升级 (Inline Editing)

### 5.1 真·行内编辑
**问题**：V2 中点击标签或编辑按钮依然弹出模态框，用户体验不够流畅（"偷懒"）。

**需求**：在**列表视图 (List View)** 下实现完全的行内编辑。

**交互设计**：
1.  **标签 (Tags) 编辑**：
    *   **UI**：点击单元格内的标签区域（或 "+" 号）。
    *   **行为**：不弹出模态框，而是原地显示一个 **Dropdown / Popover**。
    *   **内容**：显示该维度下的所有可用标签列表（支持多选/单选取决于维度定义，目前默认为多选）。
    *   **实时保存**：勾选/取消勾选后，点击外部自动保存并关闭 Dropdown。
2.  **标题/描述编辑**：
    *   保持 V2 的双击/点击编辑模式，但优化视觉反馈（如输入框自动聚焦，回车保存，ESC 取消）。
    *   确保样式与普通文本差异不大，避免突兀的输入框高度跳动。
3.  **子文档 (Sub-docs)**：
    *   **维持模态框**：点击 "内容" 列或专用按钮打开模态框，这是合理的，因为富文本不适合行内编辑。

---

## 6. 实施计划

1.  **Phase 1: 配置与路由**
    *   完善 `router/index.ts`。
    *   实现 `/settings/dimensions` 页面（排序、颜色配置）。
2.  **Phase 2: 核心交互逻辑**
    *   修复 Navigation 点击行为（一级目录点击逻辑）。
    *   实现 Sidebar -> FilterBar 的单向同步与锁定逻辑。
3.  **Phase 3: 列表视图增强**
    *   引入 Popover 组件（需自行封装或使用轻量库）。
    *   重构 `ModelList.vue` 的标签编辑逻辑。

